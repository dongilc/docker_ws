<?xml version="1.0"?>

<robot name="balancing_robot">

        <link name="body">	

		</link>

        <joint name="body_world_joint" type="fixed">
		    <origin xyz="0 0 0.2575" rpy="0.0 0.0 3.14" /> 
		    <parent link="body"/>
		    <child link="robot_body"/>
		</joint> 
        <!-- HEIGHT=1.077, origin 1.022142 -->
        <!-- HEIGHT=0.9, origin 0.845-->
        <!-- HEIGHT=0.82, origin 0.765-->

        <link name="robot_body">
            <visual>
                <origin xyz="0 0 0" rpy="0 0.0 0"/> <!--xyz="0.0 0.0 0.0" rpy="0 0.0 0" -->
                <geometry>
                    <mesh filename="package://balancing_description/meshes/body.stl" scale="0.001 0.001 0.001"/>         
                </geometry>
                <material name=""/>
            </visual>

            <collision>
                <origin xyz="0 0 0" rpy="0 0.0 0.0"/>
                <geometry>
                    <mesh filename="package://balancing_description/meshes/body.stl" scale="0.001 0.001 0.001"/>
                </geometry>
            </collision>

            <inertial>
                <mass value="20" /> <!--3.037-->
                <origin xyz="0 0 0" rpy="0 0.0 0"/>
                <inertia ixx="0.360949559" ixy="0.0"  ixz="-0.028784386"  iyy="0.254082547"  iyz="0.0"  izz="0.342506149" />
            </inertial>
        </link>

        <joint name="imu_joint" type="fixed">
            <origin xyz="0 0 0.145"/>
            <parent link="robot_body"/>
            <child link="imu_link"/>
        </joint>

        <link name="imu_link">
            <visual>
            <origin xyz="0.0 0 0.0" rpy="0 0 0"/>
            <geometry>
                <box size="0.01 0.01 0.01"/>
            </geometry>
            </visual>
        </link>

<!-- ######################################################################################### -->

        <joint name="left_wheel_joint" type="continuous">
            <!-- <origin xyz="-0.000001 0.08 -0.0015" rpy="0 0 1.57"/> -->
            <origin xyz="0 -0.175 -0.1425" rpy="0 0 3.14"/>
            <axis xyz="0 1 0" />
            <parent link="robot_body"/>
            <child link="left_wheel"/>            
            <joint_properties damping="0.0" friction="0.0"/>

        </joint>

<!-- ######################################################################################### -->

        <link name="left_wheel">
            <visual>
                <origin xyz="0.0 0.0 0.0" rpy="0 0.0 0"/> 
                <geometry>
                    <mesh filename="package://balancing_description/meshes/wheel.stl" scale="0.001 0.001 0.001"/>         
                </geometry>
                <material name=""/>
            </visual>
            <collision>
                <origin xyz="0 0 0" rpy="1.5708 0.0 0.0"/>
                <geometry>
                    <!-- <mesh filename="package://balancing_description/meshes/wheel.stl" scale="0.001 0.001 0.001"/>         -->
                <cylinder length="0.05" radius="0.115"/>
                </geometry>
            </collision>
            <inertial>
                <mass value="5" /><!-- 1.095 -->
                <origin xyz="0 0 0" />
                <inertia ixx="0.017005192" ixy="0" ixz="0" iyy="0.032049319" iyz="0" izz="0.017005189"/>
            </inertial>
        </link>

<!-- ######################################################################################### -->

        <joint name="right_wheel_joint" type="continuous">
            <!-- <origin xyz="-0.000001 0.08 -0.0015" rpy="0 0 1.57"/> -->
            <origin xyz="0 0.175 -0.1425" rpy="0 0 3.14"/>
            <axis xyz="0 1 0" />
            <parent link="robot_body"/>
            <child link="right_wheel"/>            
            <joint_properties damping="0.0" friction="0.0"/>

        </joint>

<!-- ######################################################################################### -->

        <link name="right_wheel">
            <visual>
                <origin xyz="0.0 0.0 0.0" rpy="0 0.0 0"/> 
                <geometry>
                    <mesh filename="package://balancing_description/meshes/wheel.stl" scale="0.001 0.001 0.001"/>         
                </geometry>
                <material name=""/>
            </visual>
            <collision>
                <origin xyz="0 0 0" rpy="1.5708 0.0 0.0"/>
                <geometry>
                    <!-- <mesh filename="package://balancing_description/meshes/wheel.stl" scale="0.001 0.001 0.001"/>   -->
                    <cylinder length="0.05" radius="0.115"/>      
                </geometry>
            </collision>
            <inertial>
                <mass value="5" /><!-- 1.095 -->
                <origin xyz="0 0 0" />
                <inertia ixx="0.017005192" ixy="0" ixz="0" iyy="0.032049319" iyz="0" izz="0.017005189"/>
            </inertial>
        </link>

<!-- ######################################################################################### -->

        <gazebo reference="body">
            <mu1>1.0</mu1>
            <mu2>1.0</mu2> 
            <kp>1e+13</kp>
            <kd>1.0</kd>
            <maxVel>0.001</maxVel>
            <minDepth>0.00000000001</minDepth>
            <gravity>1</gravity>
            <material>Gazebo/Grey</material>
            <!-- <selfCollide>true</selfCollide> -->
        </gazebo>

        <gazebo reference="robot_body">
            <mu1>1.0</mu1>
            <mu2>1.0</mu2> 
            <kp>1e+13</kp>
            <kd>1.0</kd>
            <maxVel>0.001</maxVel>
            <minDepth>0.00000000001</minDepth>
            <gravity>1</gravity>
            <material>Gazebo/Grey</material>
            <!-- <selfCollide>true</selfCollide> -->
        </gazebo>

        <gazebo reference="left_wheel">
            <collision name="left_wheel_collision">
                <surface>
                    <friction>
                        <torsional>
                            <coefficient>1</coefficient>
                            <use_patch_radius>true</use_patch_radius>
                            <patch_radius>0.025</patch_radius>
                        </torsional>
                    </friction>
                </surface>
            </collision>
            <mu1>1.0</mu1>
            <mu2>1.0</mu2> 
            <kp>1e+13</kp>
            <kd>1.0</kd>
            <maxVel>0.001</maxVel>
            <minDepth>0.00000000001</minDepth>
            <gravity>1</gravity>
            <material>Gazebo/White</material>
            <selfCollide>true</selfCollide>
        </gazebo>

        <gazebo reference="right_wheel">
            <collision name="right_wheel_collision">
                <surface>
                    <friction>
                        <torsional>
                            <coefficient>1</coefficient>
                            <use_patch_radius>true</use_patch_radius>
                            <patch_radius>0.02</patch_radius>
                        </torsional>
                    </friction>
                </surface>
            </collision>
            <mu1>1.0</mu1>
            <mu2>1.0</mu2> 
            <kp>1e+13</kp>
            <kd>1.0</kd>
            <maxVel>0.001</maxVel>
            <minDepth>0.00000000001</minDepth>
            <gravity>1</gravity>
            <material>Gazebo/White</material>
            <selfCollide>true</selfCollide>
        </gazebo>

        <gazebo reference="imu_link">
                <gravity>true</gravity>
                <sensor name="imu_sensor" type="imu">
                    <always_on>true</always_on>
                    <update_rate>2000</update_rate>
                    <visualize>true</visualize>
                    <topic>__default_topic__</topic>
                    <plugin filename="libgazebo_ros_imu_sensor.so" name="imu_plugin">
                        <topicName>imu</topicName>
                        <bodyName>imu_link</bodyName>
                        <updateRateHZ>2000.0</updateRateHZ>
                        <gaussianNoise>0.0</gaussianNoise>
                        <xyzOffset>0 0 0</xyzOffset>
                        <rpyOffset>0 0 0</rpyOffset>
                        <frameName>imu_link</frameName>
                        <initialOrientationAsReference>false</initialOrientationAsReference>
                    </plugin>
                    <pose>0 0 0 0 0 0</pose>
                </sensor>
        </gazebo>

<!-- ######################################################################################### -->

        <gazebo>
            <plugin name="gazebo_ros_control" filename="libgazebo_ros_control.so">
                <controlPeriod>0.001</controlPeriod>
                <robotNamespace>/balancing_robot</robotNamespace>
                <!-- <jointName> Right_gimbal_joint, Left_gimbal_joint, Left_flywheel_joint, Right_flywheel_joint, hip_roll_joint, hip_pitch_joint, knee_joint, ankle_pitch_joint, ankle_roll_joint, wheel_joint </jointName> -->
                <robotSimType>gazebo_ros_control/DefaultRobotHWSim</robotSimType>
                <legacyModeNS>true</legacyModeNS>
            </plugin>
        </gazebo>

        <transmission name="left_wheel_trans">
            <type>transmission_interface/SimpleTransmission</type>
            <joint name="left_wheel_joint" >
                <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
            </joint>
            <actuator name="left_wheel_motor">
                <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
                <mechanicalReduction>1</mechanicalReduction>
            </actuator>
        </transmission>

        <transmission name="right_wheel_trans">
            <type>transmission_interface/SimpleTransmission</type>
            <joint name="right_wheel_joint" >
                <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
            </joint>
            <actuator name="right_wheel_motor">
                <hardwareInterface>hardware_interface/EffortJointInterface</hardwareInterface>
                <mechanicalReduction>1</mechanicalReduction>
            </actuator>
        </transmission>

<!-- EffortJointInterface
PositionJointInterface
VelocityJointInterface -->

</robot>